
  create view "dbt_prod"."cayoty"."CustomerOrders__dbt_tmp"
    
    
  as (
    

WITH CUSTOMER_ORDERS AS (
SELECT 
    C.CUSTOMERID,
    CONCAT(C.FIRSTNAME, ' ', C.LASTNAME) AS CUSTOMERNAME,
    COUNT(O.ORDERID) AS NO_OF_ORDERS
FROM 
    CAYOTY.CUSTOMERS C
JOIN 
    CAYOTY.ORDERS O ON C.CUSTOMERID = O.CUSTOMERID
GROUP BY 
    C.CUSTOMERID, CUSTOMERNAME
ORDER BY 
    NO_OF_ORDERS DESC
)

SELECT CUSTOMERID, CUSTOMERNAME, NO_OF_ORDERS FROM CUSTOMER_ORDERS
  );